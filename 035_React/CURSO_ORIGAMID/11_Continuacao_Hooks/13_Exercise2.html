<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Load React, React DOM, Babel -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div id="root"></div>
</body>

<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    button,
    input {
        background-color: gray;
    }
</style>

<script type="text/babel">

    function Hello({ nomeInicial = '' }) {

        /*LEMBRANDO:
    - Quando o useState recebe uma função em vez de um valor como estado inicial,
            essa função é executada apenas durante a fase mount do componente, sem se
            repetir na fase update (re-render caso o estado alterar seu valor)
        */

        // ESSE DOC PRECISA TER SUA ANÁLISE FINALIZADA! (23/03) aula

        const [nome, setNome] = React.useState(() => window.localStorage.getItem('name') || nomeInicial)
        const [count, setCount] = React.useState(0)
        const [nameUC, setNomeUC] = React.useState(() => window.localStorage.getItem('nameUC') || nomeInicial)

        function handleChange(event) {
            setNome(event.target.value)
        }

        function handleClick(event) {
            setNomeUC(event.target.value.toUpperCase())
        }

        // Efeito colateral a ser executado após o componente ter sido atulizado
        React.useEffect(() => {
            // O valor do localStorage será atualizado após a atualização do componente
            window.localStorage.setItem('name', name)
            window.localStorage.setItem('nameUC', nameUC)
            setCount(count + 1)
        }, [name, nameUC])  // [] é a lista de dependências, ou seja, esse useEffect é para ser chamado
        // apenas quando a variável name ou a variável nameUC sofrer alteração

        return (
            <div>
                <form>
                    <label htmlFor="name">Name: </label>
                    <input value={name} onChange={handleChange} onClick={handleClick} id="name" />
                </form>
                {name ? <strong>Hello {name}, {nameUC}</strong> : 'Please type your name'}
                <p>localStorage: {window.localStorage.getItem('name')} - {window.localStorage.getItem('nameUC')}</p>
                <p>Contagem: {count}</p>
            </div>
        )
    }

    function App() {
        return <Hello nomeInicial="Thiago" />
    }

    ReactDOM.render(<App />, document.getElementById('root'))
</script>

</html>